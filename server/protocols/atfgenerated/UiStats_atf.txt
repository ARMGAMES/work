#include "pplib.h"
#include "clientplatforms.h"
#include "sites.h"
#include "dali/protocol.h"
#include "brands.h"
#include "uistats.h"

#define TOP_LEVEL_NAMESPACE UiStats

MsgBodyStruct DeviceToken
{
	PBlock mobileToken maxlen 10000;
};

// processClientRequest
namespace cli
{
	// This message is obsolete and supported only by legacy client
	Message MSG_UISTATS_SAVE_USER_STATS
	{
		PString eventData maxlen 100000;
	};
	
	Message MSG_UISTATS_SAVE_USER_STATS_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
	};
};

// processMobileAuthRequest
namespace cli_mobile
{
	// This message is obsolete
	Message MSG_UISTATS_MOBILE_DEVICE_OWNERSHIP
	{
		UINT32 deviceId; // Represents id, no need to limit
		DeviceToken deviceToken;
		UINT32 oldDeviceId; // Represents id, no need to limit
		UINT32 notificationType max 65535; // Represents mask enum on mobile client. Currently uses 3 bits
		UINT32 deviceLocale max MAX_LOCALES;
	};
	
	Message MSG_UISTATS_MOBILE_DEVICE_OWNERSHIP_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
	};
	
	Message MSG_UISTATS_MOBILE_DEVICE_OWNERSHIP_2
	{
		UINT32 deviceId; // Represents id, no need to limit
		DeviceToken deviceToken;
		UINT32 oldDeviceId; // Represents id, no need to limit
		UINT32 notificationType max 65535; // Represents mask enum on mobile client. Currently uses 3 bits
		UINT32 deviceLocale max MAX_LOCALES;
		UINT32 platformId max Client_Last;
	};
	
	Message MSG_UISTATS_MOBILE_DEVICE_OWNERSHIP_2_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
	};
	
	// This message is obsolete
	Message MSG_UISTATS_MOBILE_DEVICE_LAST_ACCESSED
	{
		UINT32 deviceId; // Represents id, no need to limit
		UINT32 platformId max Client_Last;
	};
	
	Message MSG_UISTATS_MOBILE_DEVICE_LAST_ACCESSED_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
	};
	
	Message MSG_UISTATS_MOBILE_RATE_ME
	{
		INT32 rating min 0 max 5; // Confirmed with mobile client team
	};
	
	Message MSG_UISTATS_MOBILE_RATE_ME_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
	};
};


// processMobileUnauthRequest
namespace cli_mobileUnauth
{
	Message MSG_UISTATS_MOBILE_DEVICE_REGISTRATION
	{
		UINT32 deviceId; // Represents id, no need to limit
		DeviceToken deviceToken;
		PString installId maxlen 10000;
		UINT32 platformId max Client_Last;
		UINT32 siteId min PokerStars_SiteUnknown max PokerStars_Last;
		UINT32 notificationType max 65535; // Represents mask enum on mobile client. Currently uses 3 bits
		UINT32 deviceLocale max MAX_LOCALES;
		UINT32 brandId min BrandType_None max BrandType_Last parseEndOptB4Me;
		PString appKey maxlen 65 parseEndOptB4Me;
	};
	
	Message MSG_UISTATS_MOBILE_DEVICE_REGISTRATION_REPLY
	{
		INT16 errCode;
		if (errCode)
		{
			PString errDescr;
		}
		else
		{
			UINT32 deviceId;
		}
	};
};

// Dali and Monet messages are skipped as there is no need to validate them in uistats. See details in source code.
