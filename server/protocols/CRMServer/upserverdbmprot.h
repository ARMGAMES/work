/**
 * ..\CRMServer\upserverdbmprot.h
 *
 * This file was auto-generated from ..\CRMServer\upserverdbmprot.txt by ATF protocol generator. 
 * Do not edit this file directly!
 *
 * Generator used the following keys: -genMoveConstructor ..\CRMServer\upserverdbmprot.txt
 */

#ifndef ATF_PROTOCOL_DEFFILE____CRMSERVER_UPSERVERDBMPROT_H
#define ATF_PROTOCOL_DEFFILE____CRMSERVER_UPSERVERDBMPROT_H


#include "../upserver/upservercommonprot.h"					// @no_thin_version
#include "crmserver.h"


#include "UserDefStructs.h"

namespace UPServerDBM
{
	class ProtocolFactory
	{
	public:
		static Atf::MessageProtocol* createMessageProtocolObject(const char *_nameSpace, UINT32 _msgId);
		static bool validateProtocolMessageFromJSONString(const char *_nameSpace, UINT32 _msgId, const PString& _jsonString, const AtfMsgChecker* _checker, PString& _fieldsNotParseEnded);
		static bool validateProtocolMessage(const char *_nameSpace, UINT32 _msgId, CommMsgParser& _parser, const AtfMsgChecker* _checker, PString& _fieldsNotParseEnded);
	};


	struct DBData
	{
		//! M( <FIXME>UPServerCommon::Property</FIXME> 4<4>) - M( <FIXME>property</FIXME> ,numUserIntIds<userIntIds>)
		UPServerCommon::Property property;
		Atf::LAtfVector< UINT32, 4 > userIntIds;

		DBData();
		void clear();
		bool equals(const DBData&) const;
		const char *toTraceString(PString& _str) const;
		const char *toXmlString(const char *_element, PString& _str) const;
		bool fromXmlString(const PString& _str);
		void composeMsg(CommMsgBody& _msg, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const;
		void parseMsg(CommMsgParser& _parser);
		const char *toJSONString(PString& _str) const;
		void fromJSONString(const PString& _str);
		static void validateJSONString(const PString& _str, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		DBData(DBData&&);
		DBData& operator=(DBData&&);
	private:
		DBData(const DBData&);  // prohibit
		DBData& operator=(const DBData&);  // prohibit
#endif
	};

	struct IsUpdateAndPrevValidUntil
	{
		//! M(b <FIXME>CommUtcTime</FIXME> ) - M(isUpdate, <FIXME>validUntilPrev</FIXME> )
		bool isUpdate;
		CommUtcTime validUntilPrev;

		IsUpdateAndPrevValidUntil();
		void clear();
		bool equals(const IsUpdateAndPrevValidUntil&) const;
		const char *toTraceString(PString& _str) const;
		const char *toXmlString(const char *_element, PString& _str) const;
		bool fromXmlString(const PString& _str);
		void composeMsg(CommMsgBody& _msg, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const;
		void parseMsg(CommMsgParser& _parser);
		const char *toJSONString(PString& _str) const;
		void fromJSONString(const PString& _str);
		static void validateJSONString(const PString& _str, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		IsUpdateAndPrevValidUntil(IsUpdateAndPrevValidUntil&&);
		IsUpdateAndPrevValidUntil& operator=(IsUpdateAndPrevValidUntil&&);
	private:
		IsUpdateAndPrevValidUntil(const IsUpdateAndPrevValidUntil&);  // prohibit
		IsUpdateAndPrevValidUntil& operator=(const IsUpdateAndPrevValidUntil&);  // prohibit
#endif
	};

	struct DBDataIsUpdate
	{
		//! M( <FIXME>UPServerCommon::Property</FIXME> 4<4>4<M(b <FIXME>CommUtcTime</FIXME> )>t) - M( <FIXME>property</FIXME> ,numUserIntIds<userIntIds>,numIsUpdateForUserAndValidUntil<M(isUpdate, <FIXME>validUntilPrev</FIXME> )>,when)
		UPServerCommon::Property property;
		Atf::LAtfVector< UINT32, 4 > userIntIds;
		Atf::LAtfVector< IsUpdateAndPrevValidUntil, 4 > isUpdateForUserAndValidUntil;
		CommSrvTime when;

		DBDataIsUpdate();
		void clear();
		bool equals(const DBDataIsUpdate&) const;
		const char *toTraceString(PString& _str) const;
		const char *toXmlString(const char *_element, PString& _str) const;
		bool fromXmlString(const PString& _str);
		void composeMsg(CommMsgBody& _msg, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const;
		void parseMsg(CommMsgParser& _parser);
		const char *toJSONString(PString& _str) const;
		void fromJSONString(const PString& _str);
		static void validateJSONString(const PString& _str, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, const char* _descr, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		DBDataIsUpdate(DBDataIsUpdate&&);
		DBDataIsUpdate& operator=(DBDataIsUpdate&&);
	private:
		DBDataIsUpdate(const DBDataIsUpdate&);  // prohibit
		DBDataIsUpdate& operator=(const DBDataIsUpdate&);  // prohibit
#endif
	};

	//------------------------------------------------------------------------------
	// DBM save message
	//------------------------------------------------------------------------------

	// #define CRMDBM_Q_UPS_SAVE_PROPERTY				857 // UPServer -> DBM
	// #define CRMDBM_A_UPS_SAVE_PROPERTY				1857 // DBM -> UPServer

	struct Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY : public Atf::MessageProtocol
	{
		//! M( <FIXME>UPServerCommon::Property</FIXME> 4<4>4<M(b <FIXME>CommUtcTime</FIXME> )>t) - M( <FIXME>property</FIXME> ,numUserIntIds<userIntIds>,numIsUpdateForUserAndValidUntil<M(isUpdate, <FIXME>validUntilPrev</FIXME> )>,when)
		DBDataIsUpdate dataRow;

		Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY();
		void clear() override;
		bool equals(const Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY&) const;
		bool equals(Atf::MessageProtocol* _other) const override;
		const char *asXmlString(PString& _buf, bool _logTimeStamp) const override;
		const char *asXmlString(PString& _buf, UINT64 _timestampTicks, UINT32 _msgTime) const override;
		bool loadFromXmlString(const PString& _xmlString) override;
		const char *asTraceString(PString& _buf) const override;
		void parseMsg(CommMsgParser& _parser) override;
		void composeMsg(CommMsgBody& _body, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const override;
		UINT32 getMsgId() const override { return CRMDBM_Q_UPS_SAVE_PROPERTY; }
		const char *getMsgIdString() const override { return "CRMDBM_Q_UPS_SAVE_PROPERTY"; }
		const char *asJSONString(PString& _buf) const override;
		void loadFromJSONString(const PString& _jsonString) override;
		static void validateJSONString(const PString& _jsonString, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY(Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY&&);
		Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY& operator=(Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY&&);
	private:
		Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY(const Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY&);  // prohibit
		Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY& operator=(const Protocol_CRMDBM_Q_UPS_SAVE_PROPERTY&);  // prohibit
#endif
	};

	struct Protocol_CRMDBM_A_UPS_SAVE_PROPERTY : public Atf::MessageProtocol
	{
		// 2[s] - errCode[errStr]
		INT16 errCode;

		PString errStr;

		Protocol_CRMDBM_A_UPS_SAVE_PROPERTY();
		void clear() override;
		bool equals(const Protocol_CRMDBM_A_UPS_SAVE_PROPERTY&) const;
		bool equals(Atf::MessageProtocol* _other) const override;
		const char *asXmlString(PString& _buf, bool _logTimeStamp) const override;
		const char *asXmlString(PString& _buf, UINT64 _timestampTicks, UINT32 _msgTime) const override;
		bool loadFromXmlString(const PString& _xmlString) override;
		const char *asTraceString(PString& _buf) const override;
		void parseMsg(CommMsgParser& _parser) override;
		void composeMsg(CommMsgBody& _body, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const override;
		UINT32 getMsgId() const override { return CRMDBM_A_UPS_SAVE_PROPERTY; }
		const char *getMsgIdString() const override { return "CRMDBM_A_UPS_SAVE_PROPERTY"; }
		const char *asJSONString(PString& _buf) const override;
		void loadFromJSONString(const PString& _jsonString) override;
		static void validateJSONString(const PString& _jsonString, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		Protocol_CRMDBM_A_UPS_SAVE_PROPERTY(Protocol_CRMDBM_A_UPS_SAVE_PROPERTY&&);
		Protocol_CRMDBM_A_UPS_SAVE_PROPERTY& operator=(Protocol_CRMDBM_A_UPS_SAVE_PROPERTY&&);
	private:
		Protocol_CRMDBM_A_UPS_SAVE_PROPERTY(const Protocol_CRMDBM_A_UPS_SAVE_PROPERTY&);  // prohibit
		Protocol_CRMDBM_A_UPS_SAVE_PROPERTY& operator=(const Protocol_CRMDBM_A_UPS_SAVE_PROPERTY&);  // prohibit
#endif
	};

	//------------------------------------------------------------------------------
	// DBM load all user properties
	//------------------------------------------------------------------------------

	// #define CRMDBM_Q_UPS_GET_DATA			858 // UPServer -> DBM
	// #define CRMDBM_A_UPS_GET_DATA			1858 // DBM -> UPServer

	struct Protocol_CRMDBM_Q_UPS_GET_DATA : public Atf::MessageProtocol
	{

		Protocol_CRMDBM_Q_UPS_GET_DATA();
		void clear() override;
		bool equals(const Protocol_CRMDBM_Q_UPS_GET_DATA&) const;
		bool equals(Atf::MessageProtocol* _other) const override;
		const char *asXmlString(PString& _buf, bool _logTimeStamp) const override;
		const char *asXmlString(PString& _buf, UINT64 _timestampTicks, UINT32 _msgTime) const override;
		bool loadFromXmlString(const PString& _xmlString) override;
		const char *asTraceString(PString& _buf) const override;
		void parseMsg(CommMsgParser& _parser) override;
		void composeMsg(CommMsgBody& _body, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const override;
		UINT32 getMsgId() const override { return CRMDBM_Q_UPS_GET_DATA; }
		const char *getMsgIdString() const override { return "CRMDBM_Q_UPS_GET_DATA"; }
		const char *asJSONString(PString& _buf) const override;
		void loadFromJSONString(const PString& _jsonString) override;
		static void validateJSONString(const PString& _jsonString, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		Protocol_CRMDBM_Q_UPS_GET_DATA(Protocol_CRMDBM_Q_UPS_GET_DATA&&);
		Protocol_CRMDBM_Q_UPS_GET_DATA& operator=(Protocol_CRMDBM_Q_UPS_GET_DATA&&);
	private:
		Protocol_CRMDBM_Q_UPS_GET_DATA(const Protocol_CRMDBM_Q_UPS_GET_DATA&);  // prohibit
		Protocol_CRMDBM_Q_UPS_GET_DATA& operator=(const Protocol_CRMDBM_Q_UPS_GET_DATA&);  // prohibit
#endif
	};

	struct Protocol_CRMDBM_A_UPS_GET_DATA : public Atf::MessageProtocol
	{
		//! 2[s|4<M( <FIXME>UPServerCommon::Property</FIXME> 4<4>)>] - errCode[errStr|numUserPropertiesWithExpiry<M( <FIXME>property</FIXME> ,numUserIntIds<userIntIds>)>]
		INT16 errCode;

		PString errStr;

		Atf::LAtfVector< DBData , 4 > userPropertiesWithExpiry;	// all properties found in db

		Protocol_CRMDBM_A_UPS_GET_DATA();
		void clear() override;
		bool equals(const Protocol_CRMDBM_A_UPS_GET_DATA&) const;
		bool equals(Atf::MessageProtocol* _other) const override;
		const char *asXmlString(PString& _buf, bool _logTimeStamp) const override;
		const char *asXmlString(PString& _buf, UINT64 _timestampTicks, UINT32 _msgTime) const override;
		bool loadFromXmlString(const PString& _xmlString) override;
		const char *asTraceString(PString& _buf) const override;
		void parseMsg(CommMsgParser& _parser) override;
		void composeMsg(CommMsgBody& _body, bool _ignoreJSON = COMPOSEMSG_IGNORE_JSON_DEFAULT) const override;
		UINT32 getMsgId() const override { return CRMDBM_A_UPS_GET_DATA; }
		const char *getMsgIdString() const override { return "CRMDBM_A_UPS_GET_DATA"; }
		const char *asJSONString(PString& _buf) const override;
		void loadFromJSONString(const PString& _jsonString) override;
		static void validateJSONString(const PString& _jsonString, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);
		static void validateMsg(CommMsgParser& _parser, const AtfMsgChecker* _checker, PString& _fieldsWithUnparsedContent);

#ifdef MOVE_CONSTRUCTOR_SUPPORTED
		Protocol_CRMDBM_A_UPS_GET_DATA(Protocol_CRMDBM_A_UPS_GET_DATA&&);
		Protocol_CRMDBM_A_UPS_GET_DATA& operator=(Protocol_CRMDBM_A_UPS_GET_DATA&&);
	private:
		Protocol_CRMDBM_A_UPS_GET_DATA(const Protocol_CRMDBM_A_UPS_GET_DATA&);  // prohibit
		Protocol_CRMDBM_A_UPS_GET_DATA& operator=(const Protocol_CRMDBM_A_UPS_GET_DATA&);  // prohibit
#endif
	};
};

#endif
